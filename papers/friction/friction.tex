\documentclass[10pt,a4paper]{article}

\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{graphicx}
\begin{document}

\begin{center}
%\title{ \bf Granular Materials }
%\author{ Pawel Gniewek }
%\maketitle
\textsc{\Large Models of dry friction in granular simulations}\\[1.0cm]
\textsc{\LARGE Pawel Gniewek}\\[1.0cm]
\vspace{0.5cm}
\today

%\newpage
%\tableofcontents
\end{center}

\newpage

\section{Definitions}
Following measures are defined for the purpose of the later formalism:

Deformation:
\begin{equation}
 \xi = \max(0, R_i + R_j - |\mathbf{x}_2 - \mathbf{x}_1|)
\end{equation}

Vecotor normal to the contact surface:
\begin{equation}
 \mathbf{n} = \frac{\mathbf{x}_{i} - \mathbf{x}_j}{|\mathbf{x}_{i} - \mathbf{x}_j|}
\end{equation}
and tangential contact vector (in 2D):
\begin{equation}
 \mathbf{t} = \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix} \frac{\mathbf{x}_{i} - \mathbf{x}_j}{|\mathbf{x}_{i} - \mathbf{x}_j|}
\end{equation}


Normal and shear velocities are defined as follow:
\begin{equation}
 \dot{\xi} \equiv v_n = (\mathbf{v}_i - \mathbf{v}_j) \cdot \mathbf{n}
\end{equation}
and
\begin{equation} \label{eq:vs1}
 \mathbf{\nu}_s = (\mathbf{v}_i - \mathbf{v}_j) \cdot \mathbf{t}
\end{equation}
or in more general form:
\begin{equation}  \label{eq:vs2}
 \mathbf{\nu}^{rot}_s = (\mathbf{v}_i - \mathbf{v}_j) \cdot \mathbf{t} + \Omega_1 \times \mathbf{r}_1 + \Omega_2 \times \mathbf{r}_2
\end{equation}
where $\mathbf{r}_1$ and $\mathbf{r}_2$ go from the center of the grain to the point of the contact, and $\Omega$ being an angular velocity vector.

\section{Forces}
\begin{enumerate}
 \item Normal forces accounting for elastic deformation and energy dissipation, which can be expressed in general form as:
 \begin{equation}\label{eq:normal}
  \mathbf{F}^{n} = \mathbf{F}^{el} + \mathbf{F}^{d} = -k_n\mathbf{\xi}^{\alpha} - \gamma_n \mathbf{\xi}^{\beta}\dot{\mathbf{\xi}}
 \end{equation}


 \item Tangential forces: $\mathbf{F}^{s}$
 \item Fine structure forces: $\mathbf{F}^{f}$ - if grains have sub-structure.

\end{enumerate}


\section{Sokolowski et al. \cite{sok92, sok93}}
Normal force in Sokolowski's model takes the form of equation \ref{eq:normal} with $\alpha=1.0$, and $\beta=0.0$.
Then using equation \ref{eq:vs1} shear force is given by:

\begin{equation}
  \mathbf{F}^{s}_i = -\gamma_s m_i \mathbf{\nu}_s
\end{equation}

However this model provides incorrect behavior for large velocoties since shear force should be restricted 
by normal force (Coulomb friction). Additioanlly rotation of grains has been also neglected. 
However when nonspherical shape of grains  strongly surpresses rotation and the effects of normal forces on friction can be neglected.

For the case where non-spherical particles are needed so called "site-site" model is used. In site-site model, non-spherical
grains are represented as a collection of rigiditly glued spheres - Figure \ref{fig:shapes}.
Dynamics is solved in the same way as for spherical particles but for this case rotation of particles is also taken into account:

\begin{equation}
 \mathbf{F}^{s}_{ij} = \left[\mathbf{F}^{n}_i + \min(\mathbf{F}^{slide}_{ij}, \mathbf{F}^{roll}_{ij})\right]  \frac{ \mathbf{t}_{ij} } { |\mathbf{t}_{ij}| }
\end{equation}

where sliding force for spheres \textit{i} and \textit{j} belonging to grains \textit{n} and \textit{m} is:
\begin{equation}
 \mathbf{F}^{slide}_{ij} = -\gamma_s m_i \nu^{rot}_s
\end{equation}
and rolling force is:
\begin{equation}
 \mathbf{F}^{roll}_{ij} = -\mu\mathbf{F}^{n}_{i} \cdot \mathbf{t}_{ij} \frac{ \mathbf{t}_{ij}} { |\mathbf{t}_{ij}|^2 }
\end{equation}

Again static friction is neglected. % for simplicity and because models usually glue particles together to impose static friction.
However sliding and rolling forces on top of intrinsic roughness of grains implicityly incorporate effects of static friction.
%Additionally roughness (and by this ability to dissipate kinetic energy) 
%of the box in which grains were simulated was accounted by giridly packing of particles similar to the ones used in simulation.

\begin{figure}[tb]
\centering
\includegraphics[width=0.8\textwidth]{./pics/shapes.png}
\caption{On the left tetrahedron is represented as 4 spheres. On the lest cube is represented as 9 spheres of different size. In each case spheres are rigidly connected.}
\label{fig:shapes}
\end{figure}

\section{Poschel and Buchholtz \cite{pb93, pb94, pb95}}
Despite the fact that many properties of nonspherical granular materials are consequences of static friction,
Poschel and Buchholtz \textbf{show that such properites can be reproduced in simulations without explicityly inlcuding static friction.}
Nonspherical particles are represented as a collection of interacting spheres - Figure \ref{fig:pb}. 
The total force expirienced by a pair of spheres is:
\begin{equation}
 \mathbf{F} = \mathbf{F}^{n} + \mathbf{F}^{s} + \mathbf{F}^{f}
\end{equation}

Contrary to the representation in Figure \ref{fig:shapes} (\cite{sok93}), spheres are not glued rigidly but connected by elastic springs - Figure \ref{fig:pb}.
To prevent sub-structural vibration damping component is also included:
\begin{equation}
 |\mathbf{F}^{f}_{ij}| =k_\alpha \left(C_{ij} -  |\mathbf{x}_{i} - \mathbf{x}_j| \right) + \gamma_{f} \frac{m_i}{2} |\dot{\mathbf{x}}_{i} - \dot{\mathbf{x}}_j|
\end{equation}
where $k_\alpha$ is the spring constant, and $\gamma_{f}$ is the dumping coefficient. $C_{ij}$ is the \textit{equilibrium} distance between spheres i and j
which belong to the same grain.
%As it can be seen, interaction between particles in the same  graine are purely geometric without any intergrain friction.
The static friction should be an emergent property as a result of grains' roughness. 
An exception are spherical particles for which static friction has been included as:\cite{cs79, herr93, herr94}:
 
\begin{equation}
\mathbf{F}^{s}_{i} = - \min(\gamma_{s} \tilde{m} |\mathbf{\nu}^{rot}_s| , \mu \mathbf{F}^{n}_{i} ) \frac{\mathbf{\nu}^{rot}_s}{|\mathbf{\nu}^{rot}_s|}
\end{equation}
where:
$\gamma_s$ kinetic friction coefficient, $\mu$ - static friction coefficient, and $\tilde{m} = \frac{m_1m_2}{m_1+m_2}$


%The spatial configuration of these spheres or polygons represents the microstructure of non-spherical particles. 
%No explicit static friction force need to be used for these compound non-spherical objects.

\begin{figure}[tb]
\centering
\includegraphics[width=0.8\textwidth]{./pics/pb.png}
\caption{Square representad as a collection of 5 spheres conneced by (relatively stiff) harmonic springs. Roughness of the edges imitate static friction of the square.}
\label{fig:pb}
\end{figure}

\section{Schafer et al. \cite{sw95, schafer96}}
\subsection{Normal Impacts - limits of application of elasticity theory}
Two colliding spheres undergo a deformation which is between perfeclty elastic and inelastic. Dissipation of kinetic energy may go through
plastic deformation, visoelasticity, or exception of elastic waves. 
The elasticity of the impact is phenomenologically described by coefficient of normal resustitution being defined as $\epsilon = -v^{after}_n/v^{before}_n$. 
%It is important to remember that $\epsilon$ depends on the particular case of collision but may also depend on the velocity of impact.
For two elastic materials, plastic deformation may occur for the object with the velocity of impact higher of equal to:
\begin{equation} \label{eq:impact}
 v^2_{yield} \approx 107 \frac{R^3_{eff} Y^5}{\tilde{m} E^4_{eff}}
\end{equation}
where : $\tilde{m} = \frac{m_1m_2}{m_1 + m_2}$, $R_{eff} = \frac{R_1R_2}{R_1 + R_2}$, and $\frac{1}{E_{eff}} = \frac{1-\nu^2_1}{E_1} +\frac{1-\nu^2_2}{E_2}$; 
$\nu$ being Poisson's ratio. Below this limit no plastic deformation occurs and the energy is dissipated in a viscoelastic way.
Modeling such force requires two components: repulsion and some sort of dissipation. The simplest form is damped harmonic oscilator - eq.\ref{eq:normal}:
\begin{equation}
 F_{n} = \min(0,-k_n\xi - \gamma_n \dot{\xi})
\end{equation}
where: $k_n$ is material stiffnes, and $\gamma_n$ is a damping coefficient. Min funciton is added so the force is always repulsive,
because $-k_n\xi - \gamma_n \dot{\xi}$ may become positive near the end of a collision.
For Hertz theory this equation reads:
\begin{equation}
 F_{n} = \min \left(0, -\frac{4 \sqrt{R_{eff}} E_{eff}}{3} \xi^{3/2} \right)  =  \min(0, -\hat{k}_{n}\xi^{3/2})
\end{equation}
which can be extendet do dissipative Hertz by adding term: $- \gamma_n \dot{\xi}$, however this model leads to the increase of
elasticity(i.e. $\epsilon$) as the velocity of impact increases which is contrary to experiments, which can be corrected by 
introducing term: $ -\hat{\gamma}_n \xi^{1/2} \dot{\xi}$.



\subsection{Frictinal contacts}
Static friction for $\nu_s = 0$:
\begin{equation}
 \mathbf{F}^s \le \mu_s \mathbf{F}^n
\end{equation}
and dynamic friction for $v_s \ne 0$:
\begin{equation}
 \mathbf{F}^s = \mu_s \mathbf{F}^n
\end{equation}

For similar bodies shear stress do not modify normal force so Hertz model can be still applied. 
The simpliest dynamic shear force applies Coulomb rule \cite{haff86}:
\begin{equation}
 \mathbf{F}^s = -\mu |\mathbf{F}^n| \frac{\nu_s}{|\nu_s|}
\end{equation}
Obviously it cannot provide reversal of tangential velocity - it can only slow down $v_s$ to zero.
Moreover this model has discontinouity at $v_s = 0$ which in rolling regime ($v_s \rightarrow 0$) gives jumps in the sign of 
$F_s$ instead of just 0.

Sometimes viscous friciton is also introdued \cite{sok92b}:
\begin{equation}
 \mathbf{F}^s = -\gamma_s \nu_s
\end{equation}
where: $\gamma_s$ is shear damping constant. % with no clear physical meaning but it should provide values high enough for collisional properties.
The problem is that when the force is nearly the same or larger than the normal force,
model provides incorrect description (since it is not limited by $\mathbf{F}^n$).
These two problems can be overcome by \cite{pb93, pb94, pb95}:
\begin{equation}
 \mathbf{F}^s = -\min(|\gamma_s \nu_s|,|\mu \mathbf{F}^n|) \cdot \frac{\nu_s}{|\nu_s|}
\end{equation}

Finally the problem is that these models do not account for tangential elasticity. 
The shear friction forces discussed above can only slow down the motion in the tangential direction.
These rules are inadequate for applications that require truly static friction, such as heap formation, angles of repose, and
the quasi-static stages of avalanches.  In such situations, there is a threshold force below which the grains do not move at  all, 
opposed by static friction originating in the even smaller scale surface interactions of particle contact. 
However implementations of a simple threshold rule are history dependent and computationally expensive. 


\subsection{Tangential elasticity}
Tangential elasticity was first introuced by Cundell and Stuck \cite{cs79}, providing very accurate results and is given as:
\begin{equation} \label{eq:fs}
 \mathbf{F}^s = -\min(|k_s \xi_s|,|\mu \mathbf{F}^n|) \cdot sign(\xi_s)
\end{equation}
where: $k_s$ is some tangential elasticity, and $\xi_s$ is the total dispalcement in a tangential direction that took place
since the moment of a contact creation(at $t_0$):
\begin{equation}
 \xi_s(t) = \int^{t}_{t_0} \nu_s(t')dt'
\end{equation}
The interpretation of this model is a \textbf{transverse spring introduced at the position of contact}, which opose deformation of the contat.
A naive implementation of these equations can lead to some unphysical behavior,
since long-lasting contacts may involve several changes from rolling to sliding and
back, without breaking contact between the disks. This in turn can produce arbitrarily large values for $\xi$, 
since by definition it keeps on growing even when the
disks are sliding. 
The second difficulty is that representing static friction with a fictitious spring has the disadvantage 
of introducing tangential oscillations in the
system. In order to damp them one needs to put some dissipation in this tangential
interaction. Following the linear-spring dash-pot model one needs to add to \ref{eq:fs}
a term of the form $\gamma_s \dot{\xi}$ \cite{perez}.

%The cotinuation of the tangential elasticity model is the model introducing force dependend elastcity \cite{wb86}:
%\begin{equation}
% \mathbf{F}^s(t+1) = \mathbf{F}^s(t) + k_s(\mathbf{F}^s(t), \mathbf{F}^n(t), \Delta \xi_s(t)) |\xi_s(t-1) - \xi_s(t)|
%\end{equation}
%where $t$ denotes "time steps" performed in integration scheme till break of the contact. 
%In general $k_s$ incorporates information on initial parameters of the contact, directionality of a deformation of the contact,
%and normal deformation of the grain.

\section{Mucha et al \cite{mucha05}}
In order to draw upon the existing theory for spherical particles, non-spherical particles are modeled with collections of spheres - Figure \ref{fig:camel}, 
avoiding overly stiff interactions by replacing internal springs by rigid constraints. 
With static friction obtained via normal forces between compounds of spheres, shear model is reduced to dynamic shear forces.
In such model the net force on a grain is simply the sum of the individual contact forces applied to its particles,
and static friction is the results of roughness of she surface. \textbf{Thus as a result of geometric hindrances static friction emerges implicityly.}

\begin{figure}[tb]
\centering
\includegraphics[width=0.8\textwidth]{./pics/camel.png}
\caption{Camel represented as a set of small spheres. Other objects may interact with the camel by individual interaction with each sphere separately.}
\label{fig:camel}
\end{figure}

\section{Comments}
\begin{enumerate}
 \item For our considerations impact velocities are so small that we can neglect possibility of plastic deformaiton fiven by \ref{eq:impact}
\end{enumerate}




\thispagestyle{empty} % No slide header and footer

\bibliographystyle{unsrt}
\bibliography{article}

\clearpage

\end{document}

%-Cruavzte ssh --progress --no-whole-file --stats --sparse --exclude *.svn*

